#!/bin/bash

while getopts ":o:" opt; do
  case $opt in
    o)
      CONFIG_FILE=$OPTARG
      ;;
    \?)
      echo "Invalid option: -$OPTARG" >&2
      exit 1
      ;;
  esac
done
CONFIG=${CONFIG_FILE:-k8s-scripts.config}

if test -f "$CONFIG" ; then
  echo "Configuration file, $CONFIG, already exists"
  exit 0
fi

cat <<EOT >> $CONFIG
# Configuration for https://github.com/reactiveops/rok8s-scripts

# Dockerfile to build
DOCKERFILE='Dockerfile'

# Docker tag that will be created
DOCKERTAG="quay.io/example-org/example-app"

# Namespace to work in
NAMESPACE='default'

# List of Helm charts to deploy (paths relative to deploy directory)
HELM_CHARTS=('charts/example')

# Corresponding release name(s) for charts listed above
HELM_RELEASE_NAMES=('example')

# Corresponding values files to use for charts listed above (paths relative to deploy directory)
HELM_VALUES=('values/development')

# Corresponding Helm timeout values for charts listed above (number of seconds to wait for deployment to succeed)
HELM_TIMEOUTS=('400')
EOT

echo "Wrote example config to $CONFIG"
